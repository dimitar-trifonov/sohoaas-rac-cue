## Google Calendar
1. Debugging URL to get real calendar event id: 
https://calendar.google.com/calendar/u/0/r?gsessionid=OK&eventdeb=1
- click on the event
- click on the three dots
- select Troubleshooting info
- look for eid

## Get a Google OAuth access token (OAuth 2.0 Playground)

Use Google OAuth 2.0 Playground to mint a user access token for testing MCP tools.

1. Open: https://developers.google.com/oauthplayground
2. Click the gear icon (top-right) → enable "Use your own OAuth credentials".
   - Enter your GOOGLE_CLIENT_ID and GOOGLE_CLIENT_SECRET
3. In Step 1, select the scopes you need, e.g.:
   - Calendar (read): https://www.googleapis.com/auth/calendar.readonly
   - Calendar (read/write): https://www.googleapis.com/auth/calendar.events
   - Gmail send: https://www.googleapis.com/auth/gmail.send
   - Docs: https://www.googleapis.com/auth/documents, https://www.googleapis.com/auth/drive.file
   - Drive: https://www.googleapis.com/auth/drive
4. Click "Authorize APIs" and complete the Google consent.
5. In Step 2, click "Exchange authorization code for tokens".
6. Copy the Access token value. This is the Google token required by MCP tools.
7. (Optional) To get a Refresh token: check "Include credentials in the URI" in settings before step 4; store securely.

Example: call MCP Calendar list_events with the token

```bash
MCP_URL="https://<your-mcp-domain>"            # e.g. Cloud Run URL
ACCESS_TOKEN="<GOOGLE_OAUTH_ACCESS_TOKEN>"     # from Step 6

TIME_MIN=$(date -u +"%Y-%m-%dT%H:%M:%SZ")
TIME_MAX=$(date -u -d "+2 days" +"%Y-%m-%dT%H:%M:%SZ")

curl -sS -X POST "$MCP_URL/api/mcp/tools/call" \
  -H "Content-Type: application/json" \
  -d "$(jq -nc --arg token "$ACCESS_TOKEN" --arg tmin "$TIME_MIN" --arg tmax "$TIME_MAX" \
      '{name:"calendar.list_events", arguments:{ token:$token, time_min:$tmin, time_max:$tmax, max_results:50 }}')" \
| jq -r '.result.content[0].text' \
| jq '{total: .total_count, next: .next_token, events: [.events[] | {id: .event_id, title: .title, start: .start_time, end: .end_time}]}'
```

Notes:
- Pass the token in JSON as arguments.token (MCP does not read Authorization headers for tool calls).
- Ensure the scopes match the tool being used; insufficient scopes will cause API errors.

## Gotchas

- __Time window order__: `time_min` must be earlier than `time_max`. Reversed bounds yield empty results.
- __Primary calendar only__: Current proxy lists/operates on the `primary` calendar (`calendar_proxy.go`). Events on other calendars won’t show.
- __Token placement__: Pass the Google token as `arguments.token` in the JSON body; Authorization header is not used by MCP tool calls.
- __Scopes required__: Use appropriate scopes. Examples:
  - List/read: `https://www.googleapis.com/auth/calendar.readonly`
  - Create/update/delete: `https://www.googleapis.com/auth/calendar.events`
- __Token expiry__: Playground access tokens expire quickly; refresh or mint a new token if you see 401/invalid_grant.
- __Timezone format__: Use RFC3339 (e.g., `2025-08-20T00:00:00Z` or `+03:00`). Large offsets can push your window outside expected times.
- __Pagination__: Only the first page is fetched. If many events are expected, increase `max_results` (default 10). `next_token` is returned for awareness.